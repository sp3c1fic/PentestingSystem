using Microsoft.AspNetCore.Mvc;
using PentestingSystem.Core.Contracts;


namespace PentestingSystem.Controllers;

public class SSLCertificateCheckerController : Controller
{
    private readonly ISSLCertificateCheckService _sslCertificateCheckService;

    public SSLCertificateCheckerController(ISSLCertificateCheckService sslCertificateCheckService)
    {
        _sslCertificateCheckService = sslCertificateCheckService;
    }

    public IActionResult Index()
    {
        return View();
    }

    [HttpPost]
    public async Task<IActionResult> FetchCertificateInfo(string domain)
    {

        var certificateModel = await _sslCertificateCheckService.FetchCertificate(domain);
        return PartialView("_SSLCertificateCheck" ,certificateModel);
    }
}
using Microsoft.AspNetCore.Mvc;
using PentestingSystem.Core.Contracts;

namespace PentestingSystem.Controllers;

public class SSLCertificateCheckerController : Controller
{
    private readonly IToolsService _toolsService;

    public SSLCertificateCheckerController(IToolsService toolsService)
    {
        _toolsService = toolsService;
    }

    public async Task<IActionResult> Index()

    {
        return View();
    }
    


    [HttpPost]
    public async Task<IActionResult> Index(string domain)
    {   
        var certificateModel = await _toolsService.FetchCertificate(domain);
        Console.WriteLine(certificateModel);
        Console.WriteLine(domain);

        return PartialView("_SSLCertificateCheck",certificateModel);
    }


}
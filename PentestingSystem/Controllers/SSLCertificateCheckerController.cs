using Microsoft.AspNetCore.Mvc;
using PentestingSystem.Core.Contracts;
using PentestingSystem.Models.SSLCertificateChecker;

namespace PentestingSystem.Controllers;

public class SSLCertificateCheckerController : Controller
{
    private readonly IToolsService _toolsService;

    public SSLCertificateCheckerController(IToolsService toolsService)
    {
        _toolsService = toolsService;
    }

    public IActionResult Index()
    {
        return View();
    }

    [HttpPost]
    public async Task<IActionResult> FetchCertificateInfo(string domain)
    {   
        var certificateModel = await _toolsService.FetchCertificate(domain);
        return PartialView("_SSLCertificateCheck" ,certificateModel);
    }
}
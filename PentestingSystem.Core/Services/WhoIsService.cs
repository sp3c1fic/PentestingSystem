using System.Net.Sockets;
using PentestingSystem.Core.Contracts;

namespace PentestingSystem.Core.Services;

public class WhoIsService : IWhoIsService
{
    public async Task<string> GetLookupResponse(string domainName)
    {
        using var client = new TcpClient("whois.iana.org", 43);
        await using var stream = client.GetStream();
        using var reader = new StreamReader(stream);
        await using var writer = new StreamWriter(stream);
        await writer.WriteLineAsync(domainName);
        await writer.FlushAsync();

        var response = await reader.ReadToEndAsync();

        return response;
    }
}